@{
    var model = (Model as ILayoutModelProvider)?.LayoutModel ?? new LayoutModel();
}
@inject Blog.Services.PermissionsService Permissions

<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="~/css/site.css">

    <title>@ViewData["Title"]</title>
</head>

<body>
    <a asp-page="/Index">Home</a>
    @if (User.Identity.IsAuthenticated)
    {
        <a asp-page="/Account/Profile">@User.Identity.Name</a>
        <a asp-controller="Account" asp-action="Logout">Logout</a>
    }
    else
    {
        <a asp-page="/Account/Login">Login</a>
        <a asp-page="/Account/Register">Register</a>
    }
    @if (await Permissions.CanAccessModeratorsPanelAsync())
    {
        <a asp-page="/ModeratorPanel">Moderator panel</a>
    }
    <hr />

    @foreach (var message in model.Messages)
    {
        <div>
            <span>@message.Text</span>
            <button onclick="removeParent(this)">Close</button>
        </div>
    }

    @RenderBody()

    <hr />
    <h6>GataullinRR</h6>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <partial name="_JQuery" />
    <script src="~/lib/jquery-ajax-unobtrusive/dist/jquery.unobtrusive-ajax.min.js"></script>
    <script src="~/lib/jquery-validation/dist/jquery.validate.js" type="text/javascript"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.js" type="text/javascript"></script>

    <script>
        function removeParent(element) {
            var container = element.parentElement;
            container.parentElement.removeChild(container);

            return true;
        }
    </script>

    @RenderSection("Scripts", required: false)
</body>
</html>
